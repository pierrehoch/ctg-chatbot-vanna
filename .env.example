# Environment Variables Configuration

## Option 1: Database URL (Recommended) ‚≠ê

```bash
# Copy this to your .env file or set as environment variable
RENDER_DATABASE_URL=postgresql://your_username:your_password@your_host.render.com:5432/your_database_name
```

## Option 2: Individual Credentials (Fallback)

```bash
# If you prefer to use individual credentials instead
RENDER_DB_HOST=your_host.render.com
RENDER_DB_PORT=5432
RENDER_DB_NAME=your_database_name
RENDER_DB_USER=your_username
RENDER_DB_PASSWORD=your_password
```

## Other Configuration Variables

```bash
# OpenAI API Key (for embeddings generation)
OPENAI_API_KEY=sk-...

# Render App Name (optional, for logging)
RENDER_APP_NAME=elevio-clinical-trials

# Other settings...
```

## How to Get Your Values

### From Render Dashboard:
1. Log in to [Render](https://dashboard.render.com)
2. Click on your PostgreSQL database
3. Go to the "Connections" section
4. Copy the "External Database URL"
5. This gives you everything you need!

### Breaking Down a Render URL:
```
postgresql://user_abc:pass_xyz@dpg-abc123def456.render.com:5432/mydb_prod
          ‚îî‚îÄ username  ‚îî‚îÄ password ‚îî‚îÄ host (hostname)              ‚îî‚îÄ database
```

## Deployment Scenarios

### Local Development (.env file)
```bash
RENDER_DATABASE_URL=postgresql://dev_user:dev_pass@localhost:5432/clinical_trials_dev
OPENAI_API_KEY=sk-your-dev-key
```

### Render Deployment
1. Go to your Render Web Service settings
2. Click "Environment"
3. Add new variable:
   - **Key**: `RENDER_DATABASE_URL`
   - **Value**: Copy from your database instance
4. Add OpenAI key:
   - **Key**: `OPENAI_API_KEY`
   - **Value**: Your API key

### Docker / Local Container
```bash
docker run -e RENDER_DATABASE_URL="postgresql://..." \
           -e OPENAI_API_KEY="sk-..." \
           my-app:latest
```

### GitHub Actions
```yaml
env:
  RENDER_DATABASE_URL: ${{ secrets.RENDER_DATABASE_URL }}
  OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}
```

## Important Notes

‚ö†Ô∏è **Never commit `.env` to version control!**

Add to your `.gitignore`:
```
.env
.env.local
.env.*.local
```

üí° **URL Encoding for Special Characters:**

If your password contains special characters:
- `@` ‚Üí `%40`
- `:` ‚Üí `%3A`
- `/` ‚Üí `%2F`
- `#` ‚Üí `%23`

Example:
```
Original password: user@host:pass/word
URL-encoded: user%40host%3Apass%2Fword
Full URL: postgresql://user:user%40host%3Apass%2Fword@host:5432/db
```

## Testing Your Connection

You can test your database URL with:
```python
import psycopg
from load_to_render_postgres import load_config_from_env

# This will read your RENDER_DATABASE_URL
db_config = load_config_from_env()
print(f"Database URL loaded successfully!")

# Try connecting
conn = psycopg.connect(**db_config.to_connection_kwargs())
print(f"‚úÖ Connected to database!")
conn.close()
```
